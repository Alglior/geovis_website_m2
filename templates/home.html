{% extends "base.html" %}

{% block title %}GeoVis Galaxy - Univers des Cartes Interactives{% endblock %}

{% block description %}D√©couvrez l'univers des cartes web interactives et des applications g√©ospatiales dans une exp√©rience 3D √©poustouflante{% endblock %}

{% block content %}
    <!-- Effets d'arri√®re-plan -->
    <canvas id="particles-canvas"></canvas>
    
    <!-- Section Hero avec Terre 3D -->
    <section id="hero-section" class="hero-section">
        <canvas id="heroCanvas"></canvas>
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">
                    <span class="gradient-text">GeoVis Galaxy</span>
                </h1>
                <h2 class="hero-subtitle">
                    Explorez l'Univers des Cartes Web Interactives
                </h2>
                <p class="hero-description">
                    D√©couvrez des applications g√©ospatiales √©poustouflantes, des visualisations interactives 
                    et les technologies de cartographie web les plus avanc√©es dans notre collection soigneusement s√©lectionn√©e.
                </p>
                <div class="hero-cta">
                    <button class="btn-primary cta-button" onclick="document.getElementById('maps-section').scrollIntoView({behavior: 'smooth'})">
                        Explorer les Cartes
                    </button>
                    <button class="btn-secondary" onclick="document.getElementById('features-section').scrollIntoView({behavior: 'smooth'})">
                        En Savoir Plus
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Section Cartes -->
    <section id="maps-section" class="maps-section">
        <div class="section-container">
            <div class="section-header">
                <h2 class="section-title">Collection de Cartes Interactives</h2>
                <p class="section-description">
                    Parcourez notre collection soigneusement s√©lectionn√©e de cartes web interactives et d'applications g√©ospatiales
                </p>
            </div>
            
            <!-- Racine de l'application React -->
            <div id="react-root" class="react-app-container">
                <!-- Les composants React seront mont√©s ici -->
                <div class="loading-placeholder">
                    <div class="loading-spinner"></div>
                    <p>Chargement des cartes interactives...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section Fonctionnalit√©s -->
    <section id="features-section" class="features-section">
        <div class="section-container">
            <h2 class="section-title">Pourquoi Choisir GeoVis Galaxy ?</h2>
            <div class="features-grid">

                <div class="feature-card glass-effect">
                    <div class="feature-icon">üó∫Ô∏è</div>
                    <h3>Types de Cartes Diversifi√©s</h3>
                    <p>De l'imagerie satellite aux cartes th√©matiques, des visualisations choropl√®thes aux mod√®les de terrain 3D - explorez tous les types de visualisation g√©ospatiale.</p>
                </div>

                <div class="feature-card glass-effect">
                    <div class="feature-icon"><img src="/static/earth_purple.png" alt="Earth" width="200" height="200" style="display: inline-block;"></div>
                    <h3>Insights Bas√©s sur les Donn√©es</h3>
                    <p>Chaque carte raconte une histoire √† travers la visualisation de donn√©es, vous aidant √† comprendre des patterns g√©ographiques complexes et des relations.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Section √Ä Propos -->
    <section id="about-section" class="about-section">
        <div class="section-container">
            <div class="about-content">
                <div class="about-text">
                    <h2 class="section-title">√Ä Propos de GeoVis Galaxy</h2>
                    <p class="about-description">
                        GeoVis Galaxy est une plateforme innovante d√©di√©e √† l'exploration et √† la visualisation des donn√©es g√©ospatiales.
                        Ce site a √©t√© cr√©√© dans le cadre d'un projet du Master de G√©ographie Num√©rique de Lyon 2 et de l'Universit√© Jean Monnet,
                        r√©alis√© par Arthur Thibaudon, √©tudiant en M2.
                    </p>
                    <div class="about-logos">
                        <img src="/static/logo_geonum.png" alt="G√âONUM">
                        <img src="/static/logo_jean_monnet.webp" alt="Universit√© de Lyon - Universit√© Jean Monnet">
                    </div>
                </div>
                <div class="about-image">
                    <div class="image-placeholder">
                        <span class="placeholder-icon"><img src="/static/earth_purple.png" alt="Earth" class="earth-icon"></span>
                        <p>Visualisation Interactive</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

{% endblock %}

{% block extra_js %}
<script>
// Function to update stats on the page
function updateStats() {
    fetch('/api/stats')
        .then(response => response.json())
        .then(data => {
            // Update hero section stats
            const totalMapsDisplay = document.getElementById('total-maps-display');
            const totalCategoriesDisplay = document.getElementById('total-categories-display');
            const aboutTotalMaps = document.getElementById('about-total-maps');
            
            if (totalMapsDisplay) {
                totalMapsDisplay.textContent = data.total_maps;
            }
            if (totalCategoriesDisplay) {
                totalCategoriesDisplay.textContent = data.total_categories;
            }
            if (aboutTotalMaps) {
                aboutTotalMaps.textContent = data.total_maps;
            }
        })
        .catch(error => {
            console.error('Error fetching stats:', error);
        });
}

// Update stats when page loads
document.addEventListener('DOMContentLoaded', function() {
    updateStats();
    
    // Update stats every 30 seconds
    setInterval(updateStats, 30000);
    
    // Also update when page becomes visible again (user returns to tab)
    document.addEventListener('visibilitychange', function() {
        if (!document.hidden) {
            updateStats();
        }
    });
});
</script>
{% endblock %}